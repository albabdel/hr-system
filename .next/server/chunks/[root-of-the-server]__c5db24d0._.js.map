{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 60, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/lib/db.ts"],"sourcesContent":["import mongoose from \"mongoose\";\n\nconst MONGODB_URI = process.env.MONGODB_URI!;\nif (!MONGODB_URI) throw new Error(\"MONGODB_URI missing\");\n\nlet conn = global as unknown as { mongoose: { conn: typeof mongoose | null; promise: Promise<typeof mongoose> | null } };\nif (!conn.mongoose) conn.mongoose = { conn: null, promise: null };\n\nexport async function dbConnect() {\n  if (conn.mongoose.conn) return conn.mongoose.conn;\n  if (!conn.mongoose.promise) {\n    conn.mongoose.promise = mongoose.connect(MONGODB_URI, { dbName: \"vrs\" });\n  }\n  conn.mongoose.conn = await conn.mongoose.promise;\n  return conn.mongoose.conn;\n}\n"],"names":[],"mappings":";;;AAAA;;AAEA,MAAM,cAAc,QAAQ,GAAG,CAAC,WAAW;AAC3C,IAAI,CAAC,aAAa,MAAM,IAAI,MAAM;AAElC,IAAI,OAAO;AACX,IAAI,CAAC,KAAK,QAAQ,EAAE,KAAK,QAAQ,GAAG;IAAE,MAAM;IAAM,SAAS;AAAK;AAEzD,eAAe;IACpB,IAAI,KAAK,QAAQ,CAAC,IAAI,EAAE,OAAO,KAAK,QAAQ,CAAC,IAAI;IACjD,IAAI,CAAC,KAAK,QAAQ,CAAC,OAAO,EAAE;QAC1B,KAAK,QAAQ,CAAC,OAAO,GAAG,yGAAA,CAAA,UAAQ,CAAC,OAAO,CAAC,aAAa;YAAE,QAAQ;QAAM;IACxE;IACA,KAAK,QAAQ,CAAC,IAAI,GAAG,MAAM,KAAK,QAAQ,CAAC,OAAO;IAChD,OAAO,KAAK,QAAQ,CAAC,IAAI;AAC3B","debugId":null}},
    {"offset": {"line": 88, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/models/User.ts"],"sourcesContent":["import { Schema, model, models } from \"mongoose\";\nconst UserSchema = new Schema({\n  tenantId: { type: String, index: true, required: true },\n  email: { type: String, index: true, required: true, unique: true },\n  name: String,\n  passwordHash: String,\n  role: { type: String, enum: [\"OWNER\",\"HR_ADMIN\",\"MANAGER\",\"EMPLOYEE\"], default: \"EMPLOYEE\" },\n},{ timestamps: true });\nexport default models.User || model(\"User\", UserSchema);\n"],"names":[],"mappings":";;;AAAA;;AACA,MAAM,aAAa,IAAI,yGAAA,CAAA,SAAM,CAAC;IAC5B,UAAU;QAAE,MAAM;QAAQ,OAAO;QAAM,UAAU;IAAK;IACtD,OAAO;QAAE,MAAM;QAAQ,OAAO;QAAM,UAAU;QAAM,QAAQ;IAAK;IACjE,MAAM;IACN,cAAc;IACd,MAAM;QAAE,MAAM;QAAQ,MAAM;YAAC;YAAQ;YAAW;YAAU;SAAW;QAAE,SAAS;IAAW;AAC7F,GAAE;IAAE,YAAY;AAAK;uCACN,yGAAA,CAAA,SAAM,CAAC,IAAI,IAAI,CAAA,GAAA,yGAAA,CAAA,QAAK,AAAD,EAAE,QAAQ","debugId":null}},
    {"offset": {"line": 167, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/lib/jwt.ts"],"sourcesContent":["import jwt from \"jsonwebtoken\";\nconst SECRET = process.env.JWT_SECRET!;\nexport function signJwt(payload: object, expiresIn = \"1d\") {\n  return jwt.sign(payload, SECRET, { expiresIn });\n}\nexport function verifyJwt<T = any>(token: string) {\n  return jwt.verify(token, SECRET) as T;\n}\n"],"names":[],"mappings":";;;;AAAA;;AACA,MAAM,SAAS,QAAQ,GAAG,CAAC,UAAU;AAC9B,SAAS,QAAQ,OAAe,EAAE,YAAY,IAAI;IACvD,OAAO,uIAAA,CAAA,UAAG,CAAC,IAAI,CAAC,SAAS,QAAQ;QAAE;IAAU;AAC/C;AACO,SAAS,UAAmB,KAAa;IAC9C,OAAO,uIAAA,CAAA,UAAG,CAAC,MAAM,CAAC,OAAO;AAC3B","debugId":null}},
    {"offset": {"line": 196, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/lib/tenant.ts"],"sourcesContent":["export function resolveTenantId(host?: string, headerTenant?: string) {\n  if (headerTenant) return headerTenant;\n  // subdomain: acme.verifiedrecruitmentservices.com\n  const h = host || \"\";\n  const parts = h.split(\".\");\n  if (parts.length >= 3) return parts[0]; // acme\n  return \"demo\"; // fallback for local dev\n}\n"],"names":[],"mappings":";;;AAAO,SAAS,gBAAgB,IAAa,EAAE,YAAqB;IAClE,IAAI,cAAc,OAAO;IACzB,kDAAkD;IAClD,MAAM,IAAI,QAAQ;IAClB,MAAM,QAAQ,EAAE,KAAK,CAAC;IACtB,IAAI,MAAM,MAAM,IAAI,GAAG,OAAO,KAAK,CAAC,EAAE,EAAE,OAAO;IAC/C,OAAO,QAAQ,yBAAyB;AAC1C","debugId":null}},
    {"offset": {"line": 213, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/api/auth/login/route.ts"],"sourcesContent":["import { dbConnect } from \"@/lib/db\";\nimport User from \"@/models/User\";\nimport bcrypt from \"bcrypt\";\nimport { signJwt } from \"@/lib/jwt\";\nimport { NextResponse, NextRequest } from \"next/server\";\nimport { resolveTenantId } from \"@/lib/tenant\";\n\nexport async function POST(req: NextRequest) {\n  await dbConnect();\n  \n  const { email, password } = await req.json().catch(() => ({}));\n  if (!email || !password) {\n    return NextResponse.json({ error: { message: \"Email and password are required\" } }, { status: 400 });\n  }\n\n  const tenantId = req.headers.get(\"x-tenant-id\")?.toLowerCase() || resolveTenantId();\n  const user = await User.findOne({ tenantId, email: email.toLowerCase() }).lean();\n  if (!user?.passwordHash) return NextResponse.json({ error:{message:\"Invalid credentials\"} }, { status:401 });\n\n  const ok = await bcrypt.compare(password, user.passwordHash);\n  if (!ok) return NextResponse.json({ error:{message:\"Invalid credentials\"} }, { status:401 });\n\n  const token = signJwt({ userId: String(user._id), tenantId, role: user.role || \"EMPLOYEE\" });\n  const res = NextResponse.json({ ok:true });\n  res.cookies.set(\"vrs_token\", token, { httpOnly:true, sameSite:\"lax\", path:\"/\", secure:process.env.NODE_ENV===\"production\", maxAge:60*60*24*7 });\n  return res;\n}\n"],"names":[],"mappings":";;;AAAA;AACA;AACA;AACA;AACA;AACA;;;;;;;AAEO,eAAe,KAAK,GAAgB;IACzC,MAAM,CAAA,GAAA,kHAAA,CAAA,YAAS,AAAD;IAEd,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,MAAM,IAAI,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC;IAC5D,IAAI,CAAC,SAAS,CAAC,UAAU;QACvB,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YAAE,OAAO;gBAAE,SAAS;YAAkC;QAAE,GAAG;YAAE,QAAQ;QAAI;IACpG;IAEA,MAAM,WAAW,IAAI,OAAO,CAAC,GAAG,CAAC,gBAAgB,iBAAiB,CAAA,GAAA,sHAAA,CAAA,kBAAe,AAAD;IAChF,MAAM,OAAO,MAAM,uHAAA,CAAA,UAAI,CAAC,OAAO,CAAC;QAAE;QAAU,OAAO,MAAM,WAAW;IAAG,GAAG,IAAI;IAC9E,IAAI,CAAC,MAAM,cAAc,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;QAAE,OAAM;YAAC,SAAQ;QAAqB;IAAE,GAAG;QAAE,QAAO;IAAI;IAE1G,MAAM,KAAK,MAAM,qGAAA,CAAA,UAAM,CAAC,OAAO,CAAC,UAAU,KAAK,YAAY;IAC3D,IAAI,CAAC,IAAI,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;QAAE,OAAM;YAAC,SAAQ;QAAqB;IAAE,GAAG;QAAE,QAAO;IAAI;IAE1F,MAAM,QAAQ,CAAA,GAAA,mHAAA,CAAA,UAAO,AAAD,EAAE;QAAE,QAAQ,OAAO,KAAK,GAAG;QAAG;QAAU,MAAM,KAAK,IAAI,IAAI;IAAW;IAC1F,MAAM,MAAM,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;QAAE,IAAG;IAAK;IACxC,IAAI,OAAO,CAAC,GAAG,CAAC,aAAa,OAAO;QAAE,UAAS;QAAM,UAAS;QAAO,MAAK;QAAK,QAAO,oDAAuB;QAAc,QAAO,KAAG,KAAG,KAAG;IAAE;IAC7I,OAAO;AACT","debugId":null}}]
}